.\"
.\"	SWISH++
.\"	swish++.4
.\"
.\"	Copyright (C) 1998  Paul J. Lucas
.\"
.\"	This program is free software; you can redistribute it and/or modify
.\"	it under the terms of the GNU General Public License as published by
.\"	the Free Software Foundation; either version 2 of the License, or
.\"	(at your option) any later version.
.\" 
.\"	This program is distributed in the hope that it will be useful,
.\"	but WITHOUT ANY WARRANTY; without even the implied warranty of
.\"	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\"	GNU General Public License for more details.
.\" 
.\"	You should have received a copy of the GNU General Public License
.\"	along with this program; if not, write to the Free Software
.\"	Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
.\"
.\" ---------------------------------------------------------------------------
.\" define code-start macro
.de cS
.sp
.nf
.RS 5
.ft CW
.ta .5i 1i 1.5i 2i 2.5i 3i 3.5i 4i 4.5i 5i 5.5i
..
.\" define code-end macro
.de cE
.ft 1
.RE
.fi
.sp
..
.\" ---------------------------------------------------------------------------
.TH \f3SWISH++\f1 4 "December 23, 1998" "SWISH++"
.SH NAME
SWISH++ index file format
.SH SYNOPSIS
.nf
.ft CW
.ta 10
long	num_words;
off_t	word_offset[ num_words ];
long	num_stop_words;
off_t	stop_word_offset[ num_stop_words ];
long	num_files;
off_t	file_offset[ num_files ];
long	num_meta_names;
off_t	meta_name_offset[ num_meta_names ];
.ft 2
	word index
	stop-word index
	file index
	meta-name index
.ft 1
.fi
.SH DESCRIPTION
The index file format used by SWISH++ is as shown above.
Every \f(CWword_offset\f1 is an offset into the
.I word index
pointing at the first character of a word entry;
similarly,
every \f(CWstop_word_offset\f1 is an offset into the
.I stop-word index
pointing at the first character of a stop-word entry;
similarly,
every \f(CWfile_offset\f1 is an offset into the
.I file index
pointing at the first character of a file entry;
finally,
every \f(CWmeta_name_offset\f1 is an offset into the
.I mete-name index
pointing at the first character of a meta-name entry.
.PP
The index file is written as it is so that it can be mapped into memory via the
.BR mmap (2)
Unix system call enabling ``instantaneous'' access.
.SS Word Entries
Every word entry in the
.I word index
is of the form:
.cS
\f2word\fP0\f3\s+2{\s-2\fP\f2data\fP\f3\s+2}...\s-2\fP0
.cE
that is: a null-terminated word followed by one or more
.I data
entries followed by a null byte where a
.I data
entry is:
.cS
\f2file-index\fP\f3\s+2[\s-2\fP2\f2meta-ID\fP\f3\s+2]...\s-2\fP1\f2rank\fP1
.cE
that is: a file-index followed by zero or more meta-IDs
(each preceeded by the ASCII 2 character)
followed by a rank (both preceeded and followed by the ASCII 1 character).
The integers are in ASCII, not binary.
Currently, only ASCII characters 1 and 2
(the binary values 1 and 2,
not the digits \f(CW1\f1 and \f(CW2\f1 having ASCII codes of 49 and 50 decimal,
respectively) are used.
(Other low ASCII characters are reserved for future use.)
The
.I file-index
is an index into the \f(CWfile_offset\f1 table; the
.IR meta-IDs ,
if present,
are unique integers identifying which meta name(s) a word is associated with
in the meta-name index.
.SS Stop-Word Entries
Every stop-word entry in the
.I stop-word index
is of the form:
.cS
\f2stop-word\fP0
.cE
that is: every word is null-terminated.
.SS File Entries
Every file entry in the
.I file index
is of the form:
.cS
\f2path-name file-size file-title\fP0
.cE
that is: the pathname for a file relative to where the indexing was performed
(unless absolute paths were used)
followed by the file's size in bytes
followed by the file's title
followed by a null byte.
All the information is in ASCII.
.PP
For an HTML file,
the title is what is between \f(CW<TITLE>\f1 ... \f(CW</TITLE>\f1 pairs.
If a file is not an HTML file, or is but does not have a title,
the title is simply the file (not path) name.
.SS Meta-Name Entries
Every meta-name entry in the
.I meta-name index
is of the form:
.cS
\f2meta-name\fP0
.cE
that is: every word is null-terminated.
.SH CAVEAT
Generated index files are machine-dependent
(size of data types and byte-order).
.SH SEE ALSO
.BR index (1),
.BR search (1)
.SH AUTHOR
Paul J. Lucas
.RI < pjl@best.com >
